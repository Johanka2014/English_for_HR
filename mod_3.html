<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Relations - Interactive Activities</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Lora:wght@700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #dbeafe 100%);
        }
        .activity-card {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
        }
        .activity-card:hover {
            transform: translateY(-5px);
        }
        .btn-primary {
            background: linear-gradient(to right, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 600;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }
        .btn-primary:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            transform: translateY(-2px);
        }
        .btn-start {
            padding: 1rem 2.5rem;
            font-size: 1.25rem;
            border-radius: 50px;
            background: linear-gradient(to right, #3b82f6, #60a5fa);
            color: white;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
            transition: all 0.3s ease;
        }
        .btn-start:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.5);
        }
        .nav-link {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .nav-link.active {
            background: linear-gradient(to right, #6a11cb 0%, #2575fc 100%);
            color: white;
        }
        .nav-link:not(.active) {
            color: #4a5568;
        }
        .nav-link:not(.active):hover {
            background-color: rgba(0,0,0,0.05);
        }
        .matching-item, .partnership-item, .definition-item, .sentence-half {
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s ease-in-out;
        }
        .matching-item.selected, .partnership-item.selected, .definition-item.selected, .sentence-half.selected {
            border-color: #6a11cb;
            background-color: #f3e8ff;
        }
        .matching-item.correct, .partnership-item.correct, .definition-item.correct, .sentence-half.correct {
            background-color: #c6f6d5 !important;
            border-color: #38a169 !important;
            cursor: default;
        }
        .matching-item.incorrect, .partnership-item.incorrect, .definition-item.incorrect, .sentence-half.incorrect {
            background-color: #fed7d7 !important;
            border-color: #c53030 !important;
        }
        .feedback {
            margin-top: 1rem;
            font-weight: 600;
        }
        .feedback.correct {
            color: #2f855a;
        }
        .feedback.incorrect {
            color: #c53030;
        }
        input[type="text"] {
            border-radius: 0.5rem;
            border: 1px solid #cbd5e0;
            padding: 0.5rem 0.75rem;
            width: 150px;
            transition: border-color 0.2s;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #6a11cb;
        }
        .gapped-input {
            text-align: center;
            border: none;
            border-bottom: 2px solid #cbd5e0;
            border-radius: 0;
            margin: 0 1px;
            font-weight: bold;
            color: #6a11cb;
            vertical-align: bottom;
        }
        .gapped-input:focus {
            border-color: #6a11cb;
            outline: none;
        }
        audio {
            width: 100%;
            margin-top: 1rem;
        }
        /* Category Sort & Letter Sort Styles */
        .sortable-item {
            cursor: grab;
            padding: 0.75rem;
            background-color: #e0e7ff;
            border: 2px solid #c7d2fe;
            border-radius: 0.5rem;
            transition: background-color 0.2s;
            text-align: center;
        }
        .sortable-item:active {
            cursor: grabbing;
        }
        .drop-zone {
            padding: 1rem;
            border: 2px dashed #9ca3af;
            border-radius: 0.5rem;
            background-color: #f9fafb;
            min-height: 100px;
            transition: background-color 0.2s, border-color 0.2s;
        }
        .drop-zone.drag-over {
            background-color: #dbeafe;
            border-color: #60a5fa;
        }
        em {
            font-style: italic;
            color: #4f46e5;
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Front Page Section -->
    <div id="activity-home" class="container mx-auto text-center p-8 flex flex-col items-center justify-center min-h-screen">
        <div class="w-full max-w-3xl bg-white p-6 rounded-2xl shadow-2xl">
            <img src="https://johanka2014.github.io/englishunpacked/employee_relations.png" alt="Employee Relations in London" class="w-full h-auto rounded-xl object-cover">
        </div>
        <button class="btn-start mt-10" onclick="startActivities()">Click to Start Activities</button>
    </div>

    <!-- Navigation for activities -->
    <nav id="activity-nav" class="container mx-auto mt-12 mb-8 p-4 justify-center flex-wrap gap-2 md:gap-4 bg-white/50 backdrop-blur-sm rounded-xl shadow-md w-max hidden">
        <a id="nav-0" class="nav-link active" onclick="showActivity(0)">1. Word Partnerships</a>
        <a id="nav-1" class="nav-link" onclick="showActivity(1)">2. Key Vocabulary</a>
        <a id="nav-2" class="nav-link" onclick="showActivity(2)">3. Listening (T/F)</a>
        <a id="nav-3" class="nav-link" onclick="showActivity(3)">4. Sentence Matching</a>
        <a id="nav-4" class="nav-link" onclick="showActivity(4)">5. Listening (Fill-in)</a>
        <a id="nav-5" class="nav-link" onclick="showActivity(5)">6. Category Sort</a>
        <a id="nav-6" class="nav-link" onclick="showActivity(6)">7. Word Families</a>
        <a id="nav-7" class="nav-link" onclick="showActivity(7)">8. Contract Matching</a>
        <a id="nav-8" class="nav-link" onclick="showActivity(8)">9. Complete Sentences</a>
        <a id="nav-9" class="nav-link" onclick="showActivity(9)">10. Letter Sort</a>
        <a id="nav-10" class="nav-link" onclick="showActivity(10)">11. Vocabulary Match</a>
        <a id="nav-11" class="nav-link" onclick="showActivity(11)">12. Synonym Match</a>
        <a id="nav-12" class="nav-link" onclick="showActivity(12)">13. Dealing with Grievances</a>
        <a id="nav-13" class="nav-link" onclick="showActivity(13)">14. Discuss the Article</a>
        <a id="nav-14" class="nav-link" onclick="showActivity(14)">15. True or False</a>
        <a id="nav-15" class="nav-link" onclick="showActivity(15)">16. Fill the Gaps</a>
    </nav>

    <main id="main-content" class="container mx-auto px-4 sm:px-6 lg:px-8 hidden">

        <!-- All Activity divs go here... -->
        <!-- Activity 0: Word Partnerships -->
        <div id="activity-0" class="activity-card">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 1: Word Partnerships</h2>
            <p class="mb-6 text-gray-600">Here are some word partnerships that apply to employee relations. Some of the letters are missing. Complete the words and then match them with the definitions on the right.</p>
            <div id="partnership-feedback" class="feedback mb-4 text-center"></div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div id="partnerships-container" class="space-y-3"></div>
                <div id="partnership-definitions-container" class="space-y-3"></div>
            </div>
             <div class="text-center mt-6">
                <button class="btn-primary" onclick="initPartnerships()">Reset Game</button>
            </div>
        </div>

        <!-- Activity 1: Key Vocabulary -->
        <div id="activity-1" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 2: Key Vocabulary</h2>
            <p class="mb-6 text-gray-600">Review the key vocabulary from this unit. Now match the headlines with some of the word partnerships.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div>
                    <img src="https://johanka2014.github.io/englishunpacked/Newspaper_Headlines.png" alt="Newspaper Headlines" class="w-full h-auto rounded-xl object-contain shadow-lg">
                </div>
                <div class="text-lg space-y-3 font-semibold text-gray-700">
                    <p class="p-3 bg-blue-50 rounded-lg">sex discrimination</p>
                    <p class="p-3 bg-blue-50 rounded-lg">conflict of employment</p>
                    <p class="p-3 bg-blue-50 rounded-lg">equal pay</p>
                    <p class="p-3 bg-blue-50 rounded-lg">parental leave</p>
                    <p class="p-3 bg-blue-50 rounded-lg">workplace injuries</p>
                    <p class="p-3 bg-blue-50 rounded-lg">short-term working</p>
                    <p class="p-3 bg-blue-50 rounded-lg">disciplinary and grievance procedure</p>
                    <p class="p-3 bg-blue-50 rounded-lg">work-related stress</p>
                </div>
            </div>
        </div>

        <!-- Activity 2: Listening Activity (T/F) -->
        <div id="activity-2" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 3: Listening Comprehension (True/False)</h2>
            <p class="mb-6 text-gray-600">Listen to the conversation and decide whether the following statements are true or false.</p>
            <audio controls src="https://johanka2014.github.io/English_for_HR/09.mp3">
                Your browser does not support the audio element.
            </audio>
            <div id="listening-quiz-container" class="space-y-5 mt-6"></div>
            <div class="text-center mt-8">
                <button class="btn-primary" onclick="checkListeningAnswers()">Check Answers</button>
            </div>
        </div>
        
        <!-- Activity 3: Sentence Matching -->
        <div id="activity-3" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 4: Sentence Matching</h2>
            <p class="mb-6 text-gray-600">Complete the sentences by matching the two halves.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div id="sentence-starts-container" class="space-y-3"></div>
                <div id="sentence-ends-container" class="space-y-3"></div>
            </div>
            <div id="sentence-matching-feedback" class="feedback mt-6 text-center"></div>
            <div class="text-center mt-6">
                <button class="btn-primary" onclick="initSentenceMatching()">Reset Game</button>
            </div>
        </div>

        <!-- Activity 4: Listening Activity (Fill-in) -->
        <div id="activity-4" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 5: Listening Comprehension (Fill-in)</h2>
            <p class="mb-6 text-gray-600">Listen to the extract again and fill in the missing words in each sentence.</p>
            <audio controls src="https://johanka2014.github.io/English_for_HR/09.mp3">
                Your browser does not support the audio element.
            </audio>
            <div id="listening-fill-container" class="space-y-5 mt-6"></div>
            <div class="text-center mt-8">
                <button class="btn-primary" onclick="checkListeningFill()">Check Answers</button>
            </div>
        </div>
        
        <!-- Activity 5: Category Sort -->
        <div id="activity-5" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 6: Category Sort</h2>
            <p class="mb-6 text-gray-600">Drag and drop the phrases into the correct categories.</p>
            <div class="flex flex-col gap-8">
                <div class="w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                    <div>
                        <h3 class="font-bold text-lg mb-2 text-center">Working time</h3>
                        <div class="drop-zone min-h-[200px]" data-category="working-time"></div>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg mb-2 text-center">Employment status</h3>
                        <div class="drop-zone min-h-[200px]" data-category="employment-status"></div>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg mb-2 text-center">Absence</h3>
                        <div class="drop-zone min-h-[200px]" data-category="absence"></div>
                    </div>
                    <div>
                        <h3 class="font-bold text-lg mb-2 text-center">Ending employment</h3>
                        <div class="drop-zone min-h-[200px]" data-category="ending-employment"></div>
                    </div>
                </div>
                <div id="sortable-items-container" class="w-full p-4 bg-gray-100 rounded-lg">
                    <h3 class="font-bold text-lg mb-2 text-center">Words & Phrases</h3>
                    <div id="sort-items-pool" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2"></div>
                </div>
            </div>
            <div class="text-center mt-8">
                <button class="btn-primary" onclick="checkCategorySort()">Check Answers</button>
                <button class="btn-primary bg-gray-500 hover:bg-gray-600" onclick="initCategorySort()">Reset</button>
            </div>
        </div>
        
        <!-- Activity 6: Word Families -->
        <div id="activity-6" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 7: Word Families</h2>
            <p class="mb-6 text-gray-600">Complete the following sentences with words related to the key word <b>flex</b>. (You might need to add prefixes or suffixes and change the form.)</p>
            <div id="word-families-container" class="space-y-4 text-lg"></div>
            <div class="text-center mt-8">
                <button class="btn-primary" onclick="checkWordFamilies()">Check Answers</button>
            </div>
        </div>

        <!-- Activity 7: Contract Matching -->
        <div id="activity-7" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 8: Contract Matching</h2>
            <p class="mb-6 text-gray-600">Look at the list of points that should be mentioned in a contract of employment. Match them to the extracts from some model contracts.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div id="contract-points-container" class="space-y-3"></div>
                <div id="contract-extracts-container" class="space-y-3"></div>
            </div>
            <div id="contract-matching-feedback" class="feedback mt-6 text-center"></div>
            <div class="text-center mt-6">
                <button class="btn-primary" onclick="initContractMatching()">Reset Game</button>
            </div>
        </div>

        <!-- Activity 8: Complete Sentences -->
        <div id="activity-8" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 9: Complete Sentences</h2>
            <p class="mb-6 text-gray-600">Complete these sentences with words and phrases from the box.</p>
            <div class="text-center mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200">
                <p class="font-semibold text-purple-800">can be found | notified in writing | are expected | may be required | notify | payable monthly in arrears | will be discussed | are asked | subject to disciplinary action | are entitled to</p>
            </div>
            <div id="complete-sentences-container" class="space-y-4 text-lg"></div>
            <div class="text-center mt-8">
                <button class="btn-primary" onclick="checkCompleteSentences()">Check Answers</button>
            </div>
        </div>

        <!-- Activity 9: Letter Sort -->
        <div id="activity-9" class="activity-card hidden">
             <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 10: Letter Sort</h2>
             <p class="mb-6 text-gray-600">An offer letter and a rejection letter have been mixed up. Look at the paragraphs a-j. Sort them, and put them in the correct order.</p>
             <div class="flex flex-col gap-8">
                 <div class="w-full grid grid-cols-1 md:grid-cols-2 gap-4">
                     <div>
                         <h3 class="font-bold text-lg mb-2 text-center text-green-700">Offer Letter</h3>
                         <div class="drop-zone min-h-[300px] border-green-400 bg-green-50" data-category="offer"></div>
                     </div>
                     <div>
                         <h3 class="font-bold text-lg mb-2 text-center text-red-700">Rejection Letter</h3>
                         <div class="drop-zone min-h-[300px] border-red-400 bg-red-50" data-category="rejection"></div>
                     </div>
                 </div>
                 <div id="letter-items-container" class="w-full p-4 bg-gray-100 rounded-lg">
                     <h3 class="font-bold text-lg mb-2 text-center">Paragraphs</h3>
                     <div id="letter-items-pool" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-2"></div>
                 </div>
             </div>
             <div class="text-center mt-8">
                 <button class="btn-primary" onclick="checkLetterSort()">Check Order</button>
                 <button class="btn-primary bg-gray-500 hover:bg-gray-600" onclick="initLetterSort()">Reset</button>
             </div>
        </div>

        <!-- Activity 10: Vocabulary Match -->
        <div id="activity-10" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 11: Vocabulary Match</h2>
            <p class="mb-6 text-gray-600">Match the phrases on the left with their correct definitions on the right. Click a phrase, then click its matching definition.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div id="phrases-container" class="space-y-3"></div>
                <div id="definitions-container" class="space-y-3"></div>
            </div>
            <div id="matching-feedback" class="feedback mt-6 text-center"></div>
            <div class="text-center mt-6">
                <button class="btn-primary" onclick="initMatchingGame()">Reset Game</button>
            </div>
        </div>

        <!-- Activity 11: Synonym Match -->
        <div id="activity-11" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 12: Synonym Match</h2>
            <p class="mb-6 text-gray-600">Look at these words and phrases from the letters above, and match the words in italics with similar words on the right.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div id="synonym-phrases-container" class="space-y-3"></div>
                <div id="synonym-words-container" class="space-y-3"></div>
            </div>
            <div id="synonym-matching-feedback" class="feedback mt-6 text-center"></div>
            <div class="text-center mt-6">
                <button class="btn-primary" onclick="initSynonymMatch()">Reset Game</button>
            </div>
        </div>
        
        <!-- Activity 12: Dealing with Grievances -->
        <div id="activity-12" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 13: Dealing with Grievances</h2>
            <p class="mb-6 text-gray-600">Read this article from an HR trade magazine and complete the gaps with words from the list.</p>
             <div class="text-center mb-6 p-4 bg-purple-50 rounded-lg border border-purple-200">
                <p class="font-semibold text-purple-800">behaviour | breaking | conditions | disciplinary | entitled | entitlement | occur | policy | representative | safety</p>
            </div>
            <div id="grievances-container" class="space-y-4 text-lg"></div>
            <div class="text-center mt-8">
                <button class="btn-primary" onclick="checkGrievances()">Check Answers</button>
            </div>
        </div>

        <!-- Activity 13: Discuss the Article -->
        <div id="activity-13" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 14: Discuss the Article</h2>
            <p class="mb-6 text-gray-600">Now discuss the article and the following questions.</p>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="text-lg space-y-4">
                    <p><b>1.</b> What should employees in your company do if they have a grievance? What role, if any, does the trade union play?</p>
                    <p><b>2.</b> What are some of the problems that can lead to disciplinary procedures?</p>
                    <p><b>3.</b> How do you discipline staff if they do something wrong?</p>
                </div>
                <div>
                    <img src="https://johanka2014.github.io/English_for_HR/discipline.png" alt="Disciplinary meeting" class="w-full h-auto rounded-xl object-contain shadow-lg">
                </div>
            </div>
        </div>

        <!-- Activity 14: True or False -->
        <div id="activity-14" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 15: True or False?</h2>
            <p class="mb-6 text-gray-600">Read the statements about the letter to Melanie Smith and decide if they are true or false.</p>
            <div id="true-false-container" class="space-y-5"></div>
            <div class="text-center mt-8">
                <button class="btn-primary" onclick="checkTrueFalse()">Check Answers</button>
            </div>
        </div>

        <!-- Activity 15: Fill the Gaps -->
        <div id="activity-15" class="activity-card hidden">
            <h2 class="text-2xl font-bold mb-4 text-gray-700">Activity 16: Fill the Gaps</h2>
            <p class="mb-6 text-gray-600">Complete the sentences with the correct words from the box below.</p>
            <div class="text-center mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                <p class="font-semibold text-blue-800">resigned | take on | lay off | made redundant | sacked | offered early retirement</p>
            </div>
            <div id="fill-gaps-container" class="space-y-4 text-lg"></div>
            <div class="text-center mt-8">
                <button class="btn-primary" onclick="checkFillGaps()">Check Answers</button>
            </div>
        </div>

    </main>

    <footer class="text-center py-8 mt-12 text-gray-500">
        <p>Inspired by the "English Unpacked" series.</p>
    </footer>

    <script>
        let currentActivityIndex = 0;

        // --- General Activity Switching and Cleanup ---
        function startActivities() {
            document.getElementById('activity-home').classList.add('hidden');
            document.getElementById('activity-nav').classList.remove('hidden');
            document.getElementById('activity-nav').classList.add('flex');
            document.getElementById('main-content').classList.remove('hidden');
            showActivity(0);
        }

        function destroyActivity(index) {
            switch (index) {
                case 0: destroyPartnerships(); break;
                case 2: destroyListeningQuiz(); break;
                case 3: destroySentenceMatching(); break;
                case 4: destroyListeningFill(); break;
                case 5: destroyCategorySort(); break;
                case 6: destroyWordFamilies(); break;
                case 7: destroyContractMatching(); break;
                case 8: destroyCompleteSentences(); break;
                case 9: destroyLetterSort(); break;
                case 10: destroyMatchingGame(); break;
                case 11: destroySynonymMatch(); break;
                case 12: destroyGrievances(); break;
                // No destroy for activity 13 as it's static
                case 14: destroyTrueFalse(); break;
                case 15: destroyFillGaps(); break;
            }
        }

        function initActivity(index) {
            switch (index) {
                case 0: initPartnerships(); break;
                case 2: initListeningActivity(); break;
                case 3: initSentenceMatching(); break;
                case 4: initListeningFill(); break;
                case 5: initCategorySort(); break;
                case 6: initWordFamilies(); break;
                case 7: initContractMatching(); break;
                case 8: initCompleteSentences(); break;
                case 9: initLetterSort(); break;
                case 10: initMatchingGame(); break;
                case 11: initSynonymMatch(); break;
                case 12: initGrievances(); break;
                // No init for activity 13 as it's static
                case 14: initTrueFalse(); break;
                case 15: initFillGaps(); break;
            }
        }

        function showActivity(newIndex) {
            destroyActivity(currentActivityIndex);
            document.querySelectorAll('.activity-card').forEach(card => card.classList.add('hidden'));
            document.getElementById(`activity-${newIndex}`).classList.remove('hidden');
            document.querySelectorAll('.nav-link').forEach(link => link.classList.remove('active'));
            document.getElementById(`nav-${newIndex}`).classList.add('active');
            initActivity(newIndex);
            currentActivityIndex = newIndex;
        }

        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // --- Activity 0: Word Partnerships ---
        const partnershipData = [
            { id: 'c', word: "sex discrimination", gapped: "s<input maxlength='2' data-id='c' class='gapped-input' style='width: 5ch;'> disc<input maxlength='8' data-id='c' class='gapped-input' style='width: 17ch;'>n", definition: "to treat someone of either sex unfairly" },
            { id: 'h', word: "contract of employment", gapped: "con<input maxlength='4' data-id='h' class='gapped-input' style='width: 9ch;'>ct of em<input maxlength='6' data-id='h' class='gapped-input' style='width: 13ch;'>t", definition: "written details given to an employee to confirm terms and conditions" },
            { id: 'e', word: "equal pay", gapped: "<input maxlength='2' data-id='e' class='gapped-input' style='width: 5ch;'>qu<input maxlength='2' data-id='e' class='gapped-input' style='width: 5ch;'>l pay", definition: "the same salary for men and women" },
            { id: 'd', word: "parental leave", gapped: "pa<input maxlength='6' data-id='d' class='gapped-input' style='width: 13ch;'> l<input maxlength='2' data-id='d' class='gapped-input' style='width: 5ch;'>ve", definition: "the right for parents to take time off work to look after a child" },
            { id: 'b', word: "workplace injuries", gapped: "workp<input maxlength='4' data-id='b' class='gapped-input' style='width: 9ch;'> inj<input maxlength='4' data-id='b' class='gapped-input' style='width: 9ch;'>es", definition: "accidents that happen at work" },
            { id: 'a', word: "short-time working", gapped: "s<input maxlength='3' data-id='a' class='gapped-input' style='width: 7ch;'>ort-t<input maxlength='2' data-id='a' class='gapped-input' style='width: 5ch;'>me w<input maxlength='3' data-id='a' class='gapped-input' style='width: 7ch;'>king", definition: "reduced working hours, usually when a company has a decrease in production" },
            { id: 'g', word: "disciplinary and grievance procedure", gapped: "disc<input maxlength='7' data-id='g' class='gapped-input' style='width: 15ch;'>y and gr<input maxlength='4' data-id='g' class='gapped-input' style='width: 9ch;'>van<input maxlength='1' data-id='g' class='gapped-input' style='width: 3ch;'>e procedure", definition: "procedure when an employee breaks the rules and what the employee can do if unhappy with a decision" },
            { id: 'f', word: "work-related stress", gapped: "w<input maxlength='2' data-id='f' class='gapped-input' style='width: 5ch;'>k-re<input maxlength='2' data-id='f' class='gapped-input' style='width: 5ch;'>ted st<input maxlength='3' data-id='f' class='gapped-input' style='width: 7ch;'>ess", definition: "stress caused by negative factors in the job" }
        ];
        
        let wordsState = {};
        let selectedPartnership = null;
        let selectedPartnershipDef = null;
        let partnershipCorrectMatches = 0;

        function destroyPartnerships() {
            document.getElementById('partnerships-container').innerHTML = '';
            document.getElementById('partnership-definitions-container').innerHTML = '';
            wordsState = {};
            selectedPartnership = null;
            selectedPartnershipDef = null;
            partnershipCorrectMatches = 0;
        }

        function initPartnerships() {
            destroyPartnerships();
            const wordsContainer = document.getElementById('partnerships-container');
            const defsContainer = document.getElementById('partnership-definitions-container');
            
            partnershipData.forEach(p => {
                wordsState[p.id] = { spelledCorrectly: false, matched: false };
            });

            const shuffledWords = shuffle([...partnershipData]);
            const shuffledDefs = shuffle([...partnershipData]);

            shuffledWords.forEach(p => {
                wordsContainer.innerHTML += `
                    <div id="partnership-${p.id}" class="partnership-item p-3 bg-gray-100 rounded-lg flex items-center" onclick="selectPartnership('${p.id}')">
                        <span class="font-mono">${p.gapped}</span>
                    </div>`;
            });

            shuffledDefs.forEach(p => {
                defsContainer.innerHTML += `<div id="partnership-def-${p.id}" class="definition-item p-3 bg-gray-100 rounded-lg" onclick="selectPartnershipDef('${p.id}')">${p.definition}</div>`;
            });
            
            document.querySelectorAll('.gapped-input').forEach(input => {
                input.addEventListener('input', (e) => checkSpelling(e.target.dataset.id));
            });
            
            updatePartnershipFeedback();
        }

        function checkSpelling(id) {
            const wordData = partnershipData.find(p => p.id === id);
            const container = document.getElementById(`partnership-${id}`);
            if (!container || !wordData) return;

            const inputs = container.querySelectorAll(`input[data-id="${id}"]`);
            
            let filledWord = wordData.gapped;
            inputs.forEach(input => {
                filledWord = filledWord.replace(/<input.*?>/, input.value);
            });

            if (filledWord.replace(/<[^>]*>/g, '').replace(/\s/g, '').toLowerCase() === wordData.word.replace(/\s/g, '').toLowerCase()) {
                wordsState[id].spelledCorrectly = true;
                container.style.borderColor = '#38a169';
                inputs.forEach(i => { i.disabled = true; i.style.color = '#2f855a'; });
            } else {
                wordsState[id].spelledCorrectly = false;
                container.style.borderColor = 'transparent';
            }
        }
        
        function selectPartnership(id) {
            if (!wordsState[id] || wordsState[id].matched) return;
            if (!wordsState[id].spelledCorrectly) {
                const feedbackEl = document.getElementById('partnership-feedback');
                feedbackEl.textContent = "Please spell the word correctly before matching!";
                feedbackEl.className = 'feedback mb-4 text-center incorrect';
                setTimeout(() => {
                    if(partnershipCorrectMatches < partnershipData.length) {
                         updatePartnershipFeedback();
                    }
                }, 2000);
                return;
            }
            selectedPartnership = id;
            document.querySelectorAll('.partnership-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`partnership-${id}`).classList.add('selected');
            checkPartnershipMatch();
        }

        function selectPartnershipDef(id) {
            const partnership = partnershipData.find(p => p.id === id);
            if (!partnership || (wordsState[id] && wordsState[id].matched)) return;
            selectedPartnershipDef = id;
            document.querySelectorAll('.definition-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`partnership-def-${id}`).classList.add('selected');
            checkPartnershipMatch();
        }

        function checkPartnershipMatch() {
            if (selectedPartnership !== null && selectedPartnershipDef !== null) {
                const wordEl = document.getElementById(`partnership-${selectedPartnership}`);
                const defEl = document.getElementById(`partnership-def-${selectedPartnershipDef}`);
                
                if (selectedPartnership === selectedPartnershipDef) {
                    wordsState[selectedPartnership].matched = true;
                    wordEl.classList.remove('selected');
                    defEl.classList.remove('selected');
                    wordEl.classList.add('correct');
                    defEl.classList.add('correct');
                    partnershipCorrectMatches++;
                    updatePartnershipFeedback();
                } else {
                    wordEl.classList.add('incorrect');
                    defEl.classList.add('incorrect');
                    setTimeout(() => {
                        wordEl.classList.remove('incorrect', 'selected');
                        defEl.classList.remove('incorrect', 'selected');
                    }, 1000);
                }
                selectedPartnership = null;
                selectedPartnershipDef = null;
            }
        }
        
        function updatePartnershipFeedback() {
             const feedbackEl = document.getElementById('partnership-feedback');
             feedbackEl.className = 'feedback mb-4 text-center';
             feedbackEl.textContent = `Correct Matches: ${partnershipCorrectMatches} / ${partnershipData.length}`;
             if (partnershipCorrectMatches === partnershipData.length) {
                feedbackEl.textContent = "Excellent! You've matched them all!";
                feedbackEl.classList.add('correct');
             }
        }

        // --- Activity 2: Listening Quiz (T/F) ---
        const listeningQuizData = [
            { statement: "Marion will be working flexitime in her new job.", answer: false },
            { statement: "She will be paid for the first 12 weeks if she is ill.", answer: true },
            { statement: "Her holiday entitlement is 20 days from the date she starts with Business Systems.", answer: true },
            { statement: "She sent in copies of her references with her application.", answer: true },
            { statement: "She hasn't told her employer in Marseille she's leaving yet.", answer: false },
            { statement: "She will receive the offer letter in two weeks.", answer: false }
        ];

        function destroyListeningQuiz() {
            document.getElementById('listening-quiz-container').innerHTML = '';
        }

        function initListeningActivity() {
            destroyListeningQuiz();
            const container = document.getElementById('listening-quiz-container');
            listeningQuizData.forEach((item, index) => {
                container.innerHTML += `
                    <div id="listen-q-${index}" class="p-4 border border-gray-200 rounded-lg">
                        <p class="font-semibold mb-3">${index + 1}. ${item.statement}</p>
                        <div class="flex space-x-6">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="listen-${index}" value="true" class="mr-2"> True
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="listen-${index}" value="false" class="mr-2"> False
                            </label>
                        </div>
                        <div id="listen-feedback-${index}" class="feedback mt-2"></div>
                    </div>
                `;
            });
        }

        function checkListeningAnswers() {
            listeningQuizData.forEach((item, index) => {
                const selected = document.querySelector(`input[name="listen-${index}"]:checked`);
                const feedbackEl = document.getElementById(`listen-feedback-${index}`);
                const questionContainer = document.getElementById(`listen-q-${index}`);
                
                questionContainer.style.borderWidth = '2px';

                if (selected) {
                    const isCorrect = (selected.value === String(item.answer));
                    if (isCorrect) {
                        feedbackEl.textContent = "Correct!";
                        feedbackEl.className = 'feedback correct';
                        questionContainer.style.borderColor = '#38a169';
                    } else {
                        feedbackEl.textContent = `Incorrect. The correct answer is ${item.answer}.`;
                        feedbackEl.className = 'feedback incorrect';
                        questionContainer.style.borderColor = '#c53030';
                    }
                } else {
                    feedbackEl.textContent = "Please select an answer.";
                    feedbackEl.className = 'feedback incorrect';
                    questionContainer.style.borderColor = '#c53030';
                }
            });
        }
        
        // --- Activity 4: Listening Fill-in ---
        const listeningFillData = [
            { sentence: "We currently o{} a 40-hour week (plus lunches).", answers: ["perate"] },
            { sentence: "... there may be o{} during busy periods.", answers: ["vertime"] },
            { sentence: "This is either paid or given as t{} o{} in lieu.", answers: ["ime", "ff"] },
            { sentence: "Your paid a{} holiday is 20 days.", answers: ["nnual"] },
            { sentence: "We'll be t{} up references with your previous and present employer.", answers: ["aking"] },
            { sentence: "We'll make the offer of employment 's{} to satisfactory reference'.", answers: ["ubject"] }
        ];
        
        function destroyListeningFill() {
            document.getElementById('listening-fill-container').innerHTML = '';
        }

        function initListeningFill() {
            destroyListeningFill();
            const container = document.getElementById('listening-fill-container');
            let inputCounter = 0;
            listeningFillData.forEach((item, index) => {
                let sentenceHtml = item.sentence;
                item.answers.forEach(() => {
                    sentenceHtml = sentenceHtml.replace('{}', `<input type='text' id='fill-input-${inputCounter}' class='w-24 mx-1 border-b-2 focus:border-blue-500 outline-none rounded-sm px-1'>`);
                    inputCounter++;
                });
                container.innerHTML += `
                    <div class="p-3 bg-gray-50 rounded-lg">
                        <p>${index + 1}. ${sentenceHtml}</p>
                    </div>
                `;
            });
        }

        function checkListeningFill() {
            let inputCounter = 0;
            listeningFillData.forEach(item => {
                item.answers.forEach(answer => {
                    const inputEl = document.getElementById(`fill-input-${inputCounter}`);
                    if(inputEl) {
                        if (inputEl.value.trim().toLowerCase() === answer.toLowerCase()) {
                            inputEl.style.borderColor = '#38a169';
                            inputEl.style.backgroundColor = '#c6f6d5';
                        } else {
                            inputEl.style.borderColor = '#c53030';
                            inputEl.style.backgroundColor = '#fed7d7';
                        }
                    }
                    inputCounter++;
                });
            });
        }


        // --- Activity 3: Sentence Matching ---
        const sentenceMatchingData = [
            { id: 'f', start: "I'm afraid we don't", end: "operate flexitime yet." },
            { id: 'b', start: "We'd like to tell you something", end: "about conditions of employment." },
            { id: 'a', start: "I'm sure that won't be a problem", end: "as it's only a week." },
            { id: 'e', start: "By the way, we're currently looking", end: "at more flexible working arrangements ..." },
            { id: 'd', start: "So let's start with", end: "your hours." },
            { id: 'c', start: "If you are ill, we expect you", end: "to phone in as early as possible ..." }
        ];

        let selectedSentenceStart = null;
        let selectedSentenceEnd = null;
        let sentenceCorrectMatches = 0;

        function destroySentenceMatching() {
            document.getElementById('sentence-starts-container').innerHTML = '';
            document.getElementById('sentence-ends-container').innerHTML = '';
            selectedSentenceStart = null;
            selectedSentenceEnd = null;
            sentenceCorrectMatches = 0;
        }

        function initSentenceMatching() {
            destroySentenceMatching();
            const startsContainer = document.getElementById('sentence-starts-container');
            const endsContainer = document.getElementById('sentence-ends-container');

            const starts = shuffle(sentenceMatchingData.map(item => ({ id: item.id, text: item.start })));
            const ends = shuffle(sentenceMatchingData.map(item => ({ id: item.id, text: item.end })));

            starts.forEach(item => {
                startsContainer.innerHTML += `<div id="sentence-start-${item.id}" class="sentence-half p-3 bg-gray-100 rounded-lg" onclick="selectSentenceStart('${item.id}')">${item.text}</div>`;
            });

            ends.forEach(item => {
                endsContainer.innerHTML += `<div id="sentence-end-${item.id}" class="sentence-half p-3 bg-gray-100 rounded-lg" onclick="selectSentenceEnd('${item.id}')">${item.text}</div>`;
            });
            
            updateSentenceMatchFeedback();
        }

        function selectSentenceStart(id) {
            if (document.getElementById(`sentence-start-${id}`).classList.contains('correct')) return;
            selectedSentenceStart = id;
            document.querySelectorAll('#sentence-starts-container .sentence-half').forEach(el => el.classList.remove('selected'));
            document.getElementById(`sentence-start-${id}`).classList.add('selected');
            checkSentenceMatch();
        }

        function selectSentenceEnd(id) {
            if (document.getElementById(`sentence-end-${id}`).classList.contains('correct')) return;
            selectedSentenceEnd = id;
            document.querySelectorAll('#sentence-ends-container .sentence-half').forEach(el => el.classList.remove('selected'));
            document.getElementById(`sentence-end-${id}`).classList.add('selected');
            checkSentenceMatch();
        }
        
        function updateSentenceMatchFeedback() {
             const feedbackEl = document.getElementById('sentence-matching-feedback');
             feedbackEl.textContent = `Correct Matches: ${sentenceCorrectMatches} / ${sentenceMatchingData.length}`;
             if (sentenceCorrectMatches === sentenceMatchingData.length) {
                feedbackEl.textContent = "Well done! You've matched all the sentences!";
                feedbackEl.classList.add('correct');
             } else {
                feedbackEl.classList.remove('correct');
             }
        }

        function checkSentenceMatch() {
            if (selectedSentenceStart !== null && selectedSentenceEnd !== null) {
                const startEl = document.getElementById(`sentence-start-${selectedSentenceStart}`);
                const endEl = document.getElementById(`sentence-end-${selectedSentenceEnd}`);

                if (selectedSentenceStart === selectedSentenceEnd) {
                    startEl.classList.remove('selected');
                    endEl.classList.remove('selected');
                    startEl.classList.add('correct');
                    endEl.classList.add('correct');
                    startEl.onclick = null;
                    endEl.onclick = null;
                    sentenceCorrectMatches++;
                    updateSentenceMatchFeedback();
                } else {
                    startEl.classList.add('incorrect');
                    endEl.classList.add('incorrect');
                    setTimeout(() => {
                        startEl.classList.remove('incorrect', 'selected');
                        endEl.classList.remove('incorrect', 'selected');
                    }, 1000);
                }
                
                selectedSentenceStart = null;
                selectedSentenceEnd = null;
            }
        }
        
        // --- Activity 5: Category Sort ---
        const sortableWords = [
            { text: 'shift work', category: 'working-time' },
            { text: 'notice period', category: 'ending-employment' },
            { text: 'annual leave', category: 'absence' },
            { text: 'part-time employment', category: 'working-time' },
            { text: 'trial period', category: 'employment-status' },
            { text: 'core time', category: 'working-time' },
            { text: 'sick leave', category: 'absence' },
            { text: 'public holiday', category: 'absence' },
            { text: 'resignation', category: 'ending-employment' },
            { text: 'vacation', category: 'absence' },
            { text: 'dismissal', category: 'ending-employment' },
            { text: 'fixed-term contract', category: 'employment-status' },
            { text: 'six-day week', category: 'working-time' },
            { text: 'redundancy', category: 'ending-employment' },
            { text: 'temporary employment', category: 'employment-status' },
            { text: 'flexitime', category: 'working-time' },
            { text: 'probationary period', category: 'employment-status' },
            { text: 'holiday entitlement', category: 'absence' }
        ];

        function destroyCategorySort() {
            document.getElementById('sort-items-pool').innerHTML = '';
            document.querySelectorAll('.drop-zone').forEach(zone => {
                zone.innerHTML = '';
                zone.classList.remove('drag-over');
            });
        }

        function initCategorySort() {
            destroyCategorySort();
            const pool = document.getElementById('sort-items-pool');
            const shuffledWords = shuffle([...sortableWords]);
            shuffledWords.forEach((word, index) => {
                const item = document.createElement('div');
                item.id = `sortable-${index}`;
                item.className = 'sortable-item';
                item.textContent = word.text;
                item.draggable = true;
                item.dataset.category = word.category;
                item.addEventListener('dragstart', e => {
                    e.dataTransfer.setData('text/plain', e.target.id);
                });
                pool.appendChild(item);
            });

            const dropZones = document.querySelectorAll('.drop-zone');
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', e => {
                    e.preventDefault();
                    zone.classList.add('drag-over');
                });
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('drag-over');
                });
                zone.addEventListener('drop', e => {
                    e.preventDefault();
                    zone.classList.remove('drag-over');
                    const id = e.dataTransfer.getData('text');
                    const draggableElement = document.getElementById(id);
                    zone.appendChild(draggableElement);
                });
            });
        }

        function checkCategorySort() {
            const dropZones = document.querySelectorAll('.drop-zone');
            dropZones.forEach(zone => {
                const items = zone.querySelectorAll('.sortable-item');
                items.forEach(item => {
                    if (item.dataset.category === zone.dataset.category) {
                        item.style.backgroundColor = '#c6f6d5'; // Correct
                    } else {
                        item.style.backgroundColor = '#fed7d7'; // Incorrect
                    }
                });
            });
        }

        // --- Activity 6: Word Families ---
        const wordFamiliesData = [
            { sentence: "We have a very ______ system in the company for our staff who need time off work for childcare.", answer: "flexible" },
            { sentence: "We've been operating ______ in the company since the early 90s.", answer: "flexitime" },
            { sentence: "There is little or no ______ for our staff in terms of hours of work as they have to be around when our customers need them.", answer: "flexibility" },
            { sentence: "Unfortunately, our managing director is very ______ when it comes to deadlines.", answer: "inflexible" }
        ];

        function destroyWordFamilies() {
            const container = document.getElementById('word-families-container');
            if (container) container.innerHTML = '';
        }

        function initWordFamilies() {
            destroyWordFamilies();
            const container = document.getElementById('word-families-container');
            if (!container) return;
            wordFamiliesData.forEach((item, index) => {
                const sentenceHtml = item.sentence.replace('______', `<input type="text" id="wf-gap-${index}" class="mx-2 align-middle">`);
                container.innerHTML += `
                    <div class="p-3 bg-gray-50 rounded-lg">
                        <p>${index + 1}. ${sentenceHtml}</p>
                        <div id="wf-feedback-${index}" class="feedback text-sm mt-1 ml-6"></div>
                    </div>
                `;
            });
        }

        function checkWordFamilies() {
            wordFamiliesData.forEach((item, index) => {
                const inputEl = document.getElementById(`wf-gap-${index}`);
                const feedbackEl = document.getElementById(`wf-feedback-${index}`);
                if (inputEl && feedbackEl) {
                    const userAnswer = inputEl.value.trim().toLowerCase();
                    const correctAnswer = item.answer.toLowerCase();
                    if (userAnswer === correctAnswer) {
                        feedbackEl.textContent = "Correct!";
                        feedbackEl.className = 'feedback text-sm mt-1 ml-6 correct';
                        inputEl.style.borderColor = '#38a169';
                        inputEl.style.backgroundColor = '#c6f6d5';
                    } else {
                        feedbackEl.textContent = `Not quite. The correct answer is "${item.answer}".`;
                        feedbackEl.className = 'feedback text-sm mt-1 ml-6 incorrect';
                        inputEl.style.borderColor = '#c53030';
                        inputEl.style.backgroundColor = '#fed7d7';
                    }
                }
            });
        }

        // --- Activity 7: Contract Matching ---
        const contractMatchingData = [
            { id: 'e', point: 'date the employment begins', extract: 'Your employment begins on 1 January 20...' },
            { id: 'c', point: 'rate of pay and when/how paid', extract: 'Your basic salary will be 35,000 per annum, payable monthly in arrears by credit transfer to your bank or building society.' },
            { id: 'h', point: 'normal hours of work/overtime/shift patterns', extract: 'Normal hours of work are 37 1/2 per week, 9 am to 5.30 pm Monday to Friday, with one unpaid hour for lunch each day.' },
            { id: 'g', point: 'holiday entitlement (including public holidays)', extract: 'You may be required to work on a public holiday. If so, you are entitled to time off in lieu.' },
            { id: 'j', point: 'job title (or a brief description of the job)', extract: 'Your current job title and responsibilities are detailed in Schedule 1 and may be amended from time to time.' },
            { id: 'd', point: 'location of workplace', extract: 'Your normal place of work will be the above address. From time to time the company may require you to work at other sites on a temporary basis.' },
            { id: 'a', point: 'notice period', extract: 'The amount of notice you are required to give or be given by your employer in the first four years is four weeks.' },
            { id: 'i', point: 'sick pay provision', extract: 'You must inform the office by 10 am on the first day of absence. Failure to do so may render you subject to disciplinary action and may also bar you from sick pay.' },
            { id: 'f', point: 'pension scheme terms', extract: 'The company does not offer a pension scheme but provides access to a stakeholder pension. Details can be obtained from the personnel department.' },
            { id: 'b', point: 'disciplinary rules and grievance procedure', extract: 'A copy of the company\'s disciplinary procedure is attached to this contract and employees are asked to read it carefully.' }
        ];

        let selectedContractPoint = null;
        let selectedContractExtract = null;
        let contractCorrectMatches = 0;

        function destroyContractMatching() {
            document.getElementById('contract-points-container').innerHTML = '';
            document.getElementById('contract-extracts-container').innerHTML = '';
            selectedContractPoint = null;
            selectedContractExtract = null;
            contractCorrectMatches = 0;
        }

        function initContractMatching() {
            destroyContractMatching();
            const pointsContainer = document.getElementById('contract-points-container');
            const extractsContainer = document.getElementById('contract-extracts-container');

            const points = shuffle(contractMatchingData.map(item => ({ id: item.id, text: item.point })));
            const extracts = shuffle(contractMatchingData.map(item => ({ id: item.id, text: item.extract })));

            points.forEach((item, index) => {
                pointsContainer.innerHTML += `<div id="contract-point-${item.id}" class="matching-item p-3 bg-gray-100 rounded-lg" onclick="selectContractPoint('${item.id}')">${index+1}. ${item.text}</div>`;
            });

            extracts.forEach(item => {
                extractsContainer.innerHTML += `<div id="contract-extract-${item.id}" class="matching-item p-3 bg-blue-50 rounded-lg" onclick="selectContractExtract('${item.id}')">${item.text}</div>`;
            });

            updateContractMatchFeedback();
        }

        function selectContractPoint(id) {
            if (document.getElementById(`contract-point-${id}`).classList.contains('correct')) return;
            selectedContractPoint = id;
            document.querySelectorAll('#contract-points-container .matching-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`contract-point-${id}`).classList.add('selected');
            checkContractMatch();
        }

        function selectContractExtract(id) {
            if (document.getElementById(`contract-extract-${id}`).classList.contains('correct')) return;
            selectedContractExtract = id;
            document.querySelectorAll('#contract-extracts-container .matching-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`contract-extract-${id}`).classList.add('selected');
            checkContractMatch();
        }

        function updateContractMatchFeedback() {
            const feedbackEl = document.getElementById('contract-matching-feedback');
            feedbackEl.textContent = `Correct Matches: ${contractCorrectMatches} / ${contractMatchingData.length}`;
            if (contractCorrectMatches === contractMatchingData.length) {
                feedbackEl.textContent = "Excellent! You have matched all the points correctly.";
                feedbackEl.classList.add('correct');
            } else {
                feedbackEl.classList.remove('correct');
            }
        }

        function checkContractMatch() {
            if (selectedContractPoint !== null && selectedContractExtract !== null) {
                const pointEl = document.getElementById(`contract-point-${selectedContractPoint}`);
                const extractEl = document.getElementById(`contract-extract-${selectedContractExtract}`);

                if (selectedContractPoint === selectedContractExtract) {
                    pointEl.classList.remove('selected');
                    extractEl.classList.remove('selected');
                    pointEl.classList.add('correct');
                    extractEl.classList.add('correct');
                    pointEl.onclick = null;
                    extractEl.onclick = null;
                    contractCorrectMatches++;
                    updateContractMatchFeedback();
                } else {
                    pointEl.classList.add('incorrect');
                    extractEl.classList.add('incorrect');
                    setTimeout(() => {
                        pointEl.classList.remove('incorrect', 'selected');
                        extractEl.classList.remove('incorrect', 'selected');
                    }, 1000);
                }

                selectedContractPoint = null;
                selectedContractExtract = null;
            }
        }
        
        // --- Activity 8: Complete Sentences ---
        const completeSentencesData = [
             { sentence: "Full details of the sick pay scheme ______ in the staff handbook.", answers: ["can be found"] },
             { sentence: "You ______ to work in another office of the company from time to time.", answers: ["may be required"] },
             { sentence: "Employees ______ to work overtime as and when needed.", answers: ["are expected"] },
             { sentence: "Changes to your contract ______ and you will be ______.", answers: ["will be discussed", "notified in writing"] },
             { sentence: "You ______ four weeks' holiday per annum after completion of six months' probation.", answers: ["are entitled to"] },
             { sentence: "Your salary is ______ on the last day of each month.", answers: ["payable monthly in arrears"] },
             { sentence: "Employees ______ to ______ the company of any absence by 10.a.m. on the first day.", answers: ["are asked", "notify"] },
             { sentence: "You may be ______ if you fail to do this.", answers: ["subject to disciplinary action"] }
        ];

        function destroyCompleteSentences() {
            const container = document.getElementById('complete-sentences-container');
            if (container) container.innerHTML = '';
        }

        function initCompleteSentences() {
            destroyCompleteSentences();
            const container = document.getElementById('complete-sentences-container');
            let inputCounter = 0;
            completeSentencesData.forEach((item, index) => {
                let sentenceHtml = item.sentence.replace(/______/g, () => {
                    const inputId = `cs-gap-${inputCounter++}`;
                    return `<input type="text" id="${inputId}" class="mx-2 align-middle" style="width: 200px;">`;
                });
                container.innerHTML += `
                    <div class="p-3 bg-gray-50 rounded-lg">
                        <p>${index + 1}. ${sentenceHtml}</p>
                    </div>
                `;
            });
        }
        
        function checkCompleteSentences() {
            let inputCounter = 0;
            completeSentencesData.forEach(item => {
                item.answers.forEach(answer => {
                    const inputEl = document.getElementById(`cs-gap-${inputCounter}`);
                    if (inputEl) {
                        const userAnswer = inputEl.value.trim().toLowerCase();
                        const correctAnswer = answer.toLowerCase();
                        if (userAnswer === correctAnswer) {
                            inputEl.style.borderColor = '#38a169';
                            inputEl.style.backgroundColor = '#c6f6d5';
                        } else {
                            inputEl.style.borderColor = '#c53030';
                            inputEl.style.backgroundColor = '#fed7d7';
                        }
                    }
                    inputCounter++;
                });
            });
        }
        
        // --- Activity 9: Letter Sort ---
        const letterSortingData = [
            { text: "a) We would like you to start on 1 November 2007...", category: 'offer', order: 4 },
            { text: "b) Thank you for attending the interview for the above position...", category: 'rejection', order: 2 },
            { text: "c) Further to your recent interviews, we have pleasure in offering you the position...", category: 'offer', order: 2 },
            { text: "d) Dear Ms Pelletier", category: 'offer', order: 1 },
            { text: "e) We appreciate your interest and would like to take this opportunity to wish you every success...", category: 'rejection', order: 5 },
            { text: "f) Please let us know as soon as possible if you would like to accept...", category: 'offer', order: 5 },
            { text: "g) Dear Mr Chevalier", category: 'rejection', order: 1 },
            { text: "h) We have now fully considered your application and regret we are unable to offer you a second interview...", category: 'rejection', order: 3 },
            { text: "i) Basic hours of work are normally 9 a.m. to 6 p.m. ...", category: 'offer', order: 3 },
            { text: "j) We will hold your details pending and let you know if a suitable opening occurs...", category: 'rejection', order: 4 }
        ];

        function destroyLetterSort() {
            document.getElementById('letter-items-pool').innerHTML = '';
            document.querySelectorAll('#activity-9 .drop-zone').forEach(zone => {
                zone.innerHTML = '';
                zone.classList.remove('drag-over');
            });
        }

        function initLetterSort() {
            destroyLetterSort();
            const pool = document.getElementById('letter-items-pool');
            const shuffledItems = shuffle([...letterSortingData]);
            shuffledItems.forEach((item, index) => {
                const el = document.createElement('div');
                el.id = `letter-item-${index}`;
                el.className = 'sortable-item';
                el.textContent = item.text;
                el.draggable = true;
                el.dataset.category = item.category;
                el.dataset.order = item.order;
                el.addEventListener('dragstart', e => {
                    e.dataTransfer.setData('text/plain', e.target.id);
                });
                pool.appendChild(el);
            });

            const dropZones = document.querySelectorAll('#activity-9 .drop-zone');
            dropZones.forEach(zone => {
                zone.addEventListener('dragover', e => {
                    e.preventDefault();
                    zone.classList.add('drag-over');
                });
                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('drag-over');
                });
                zone.addEventListener('drop', e => {
                    e.preventDefault();
                    zone.classList.remove('drag-over');
                    const id = e.dataTransfer.getData('text');
                    const draggableElement = document.getElementById(id);
                    zone.appendChild(draggableElement);
                });
            });
        }

        function checkLetterSort() {
            const dropZones = document.querySelectorAll('#activity-9 .drop-zone');
            dropZones.forEach(zone => {
                const items = zone.querySelectorAll('.sortable-item');
                let expectedOrder = 1;
                items.forEach(item => {
                    const isCategoryCorrect = item.dataset.category === zone.dataset.category;
                    const isOrderCorrect = parseInt(item.dataset.order) === expectedOrder;

                    if (isCategoryCorrect && isOrderCorrect) {
                        item.style.backgroundColor = '#c6f6d5'; // Correct
                    } else {
                        item.style.backgroundColor = '#fed7d7'; // Incorrect
                    }
                    expectedOrder++;
                });
            });
        }


        // --- Activity 10: Vocabulary Match ---
        const matchingData = [
            { id: 1, phrase: 'to create rapport', definition: 'to develop a good relationship' },
            { id: 2, phrase: 'to understand their needs', definition: 'to know what they want' },
            { id: 3, phrase: 'to provide advice', definition: 'to suggest the best way to do something' },
            { id: 4, phrase: 'to promote a range of services', definition: 'to attract people\'s attention to what you offer' },
            { id: 5, phrase: 'to attend an interview', definition: 'to visit a company to discuss a job' },
            { id: 6, phrase: 'to be notified of the outcome', definition: 'to be told the results of a decision' },
            { id: 7, phrase: 'to receive a shift allowance', definition: 'to get extra money for working \'unsociable\' hours' },
            { id: 8, phrase: 'to be entitled to a benefits package', definition: 'to have the right to extra advantages on top of salary' },
        ];

        let selectedPhrase = null;
        let selectedDefinition = null;
        let correctMatches = 0;

        function destroyMatchingGame() {
            document.getElementById('phrases-container').innerHTML = '';
            document.getElementById('definitions-container').innerHTML = '';
            selectedPhrase = null;
            selectedDefinition = null;
            correctMatches = 0;
        }

        function initMatchingGame() {
            destroyMatchingGame();
            const phrasesContainer = document.getElementById('phrases-container');
            const definitionsContainer = document.getElementById('definitions-container');
            
            const phrases = shuffle(matchingData.map(item => ({ id: item.id, text: item.phrase })));
            const definitions = shuffle(matchingData.map(item => ({ id: item.id, text: item.definition })));

            phrases.forEach(item => {
                phrasesContainer.innerHTML += `<div id="phrase-${item.id}" class="matching-item p-3 bg-gray-100 rounded-lg" onclick="selectPhrase(${item.id})">${item.text}</div>`;
            });

            definitions.forEach(item => {
                definitionsContainer.innerHTML += `<div id="definition-${item.id}" class="matching-item p-3 bg-gray-100 rounded-lg" onclick="selectDefinition(${item.id})">${item.text}</div>`;
            });
            
            updateFeedback();
        }

        function selectPhrase(id) {
            if (document.getElementById(`phrase-${id}`).classList.contains('correct')) return;
            selectedPhrase = id;
            document.querySelectorAll('#phrases-container .matching-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`phrase-${id}`).classList.add('selected');
            checkMatch();
        }

        function selectDefinition(id) {
            if (document.getElementById(`definition-${id}`).classList.contains('correct')) return;
            selectedDefinition = id;
            document.querySelectorAll('#definitions-container .matching-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`definition-${id}`).classList.add('selected');
            checkMatch();
        }
        
        function updateFeedback() {
             const feedbackEl = document.getElementById('matching-feedback');
             feedbackEl.textContent = `Correct Matches: ${correctMatches} / ${matchingData.length}`;
             if (correctMatches === matchingData.length) {
                feedbackEl.textContent = "Congratulations! You've matched them all!";
                feedbackEl.classList.add('correct');
             } else {
                feedbackEl.classList.remove('correct');
             }
        }

        function checkMatch() {
            if (selectedPhrase !== null && selectedDefinition !== null) {
                const phraseEl = document.getElementById(`phrase-${selectedPhrase}`);
                const definitionEl = document.getElementById(`definition-${selectedDefinition}`);

                if (selectedPhrase === selectedDefinition) {
                    phraseEl.classList.remove('selected');
                    definitionEl.classList.remove('selected');
                    phraseEl.classList.add('correct');
                    definitionEl.classList.add('correct');
                    phraseEl.onclick = null;
                    definitionEl.onclick = null;
                    correctMatches++;
                    updateFeedback();
                } else {
                    phraseEl.classList.add('incorrect');
                    definitionEl.classList.add('incorrect');
                    setTimeout(() => {
                        phraseEl.classList.remove('incorrect', 'selected');
                        definitionEl.classList.remove('incorrect', 'selected');
                    }, 1000);
                }
                
                selectedPhrase = null;
                selectedDefinition = null;
            }
        }
        
        // --- Activity 11: Synonym Match ---
        const synonymMatchingData = [
            { id: 'c', phrase: 'a <em>commencing</em> salary of ...', word: 'starting' },
            { id: 'e', phrase: 'the offer is <em>conditional on</em> receiving ...', word: 'subject to' },
            { id: 'h', phrase: '<em>probationary</em> period', word: 'trial' },
            { id: 'a', phrase: '<em>accompanying</em> details', word: 'enclosed' },
            { id: 'd', phrase: 'per <em>annum</em>', word: 'year' },
            { id: 'f', phrase: 'are <em>detailed</em> in ...', word: 'set out' },
            { id: 'b', phrase: 'to <em>familiarize</em>', word: 'learn about' },
            { id: 'g', phrase: 'We will hold your details <em>pending</em> ...', word: 'until we have something available' }
        ];

        let selectedSynonymPhrase = null;
        let selectedSynonymWord = null;
        let synonymCorrectMatches = 0;
        
        function destroySynonymMatch() {
            document.getElementById('synonym-phrases-container').innerHTML = '';
            document.getElementById('synonym-words-container').innerHTML = '';
            selectedSynonymPhrase = null;
            selectedSynonymWord = null;
            synonymCorrectMatches = 0;
        }

        function initSynonymMatch() {
            destroySynonymMatch();
            const phrasesContainer = document.getElementById('synonym-phrases-container');
            const wordsContainer = document.getElementById('synonym-words-container');

            const phrases = shuffle(synonymMatchingData.map(item => ({ id: item.id, text: item.phrase })));
            const words = shuffle(synonymMatchingData.map(item => ({ id: item.id, text: item.word })));

            phrases.forEach(item => {
                phrasesContainer.innerHTML += `<div id="synonym-phrase-${item.id}" class="matching-item p-3 bg-gray-100 rounded-lg" onclick="selectSynonymPhrase('${item.id}')">${item.text}</div>`;
            });

            words.forEach(item => {
                wordsContainer.innerHTML += `<div id="synonym-word-${item.id}" class="matching-item p-3 bg-blue-50 rounded-lg" onclick="selectSynonymWord('${item.id}')">${item.text}</div>`;
            });
            
            updateSynonymMatchFeedback();
        }
        
        function selectSynonymPhrase(id) {
            if (document.getElementById(`synonym-phrase-${id}`).classList.contains('correct')) return;
            selectedSynonymPhrase = id;
            document.querySelectorAll('#synonym-phrases-container .matching-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`synonym-phrase-${id}`).classList.add('selected');
            checkSynonymMatch();
        }

        function selectSynonymWord(id) {
            if (document.getElementById(`synonym-word-${id}`).classList.contains('correct')) return;
            selectedSynonymWord = id;
            document.querySelectorAll('#synonym-words-container .matching-item').forEach(el => el.classList.remove('selected'));
            document.getElementById(`synonym-word-${id}`).classList.add('selected');
            checkSynonymMatch();
        }
        
        function updateSynonymMatchFeedback() {
             const feedbackEl = document.getElementById('synonym-matching-feedback');
             feedbackEl.textContent = `Correct Matches: ${synonymCorrectMatches} / ${synonymMatchingData.length}`;
             if (synonymCorrectMatches === synonymMatchingData.length) {
                feedbackEl.textContent = "Great job! You've matched all the synonyms!";
                feedbackEl.classList.add('correct');
             } else {
                feedbackEl.classList.remove('correct');
             }
        }
        
        function checkSynonymMatch() {
            if (selectedSynonymPhrase !== null && selectedSynonymWord !== null) {
                const phraseEl = document.getElementById(`synonym-phrase-${selectedSynonymPhrase}`);
                const wordEl = document.getElementById(`synonym-word-${selectedSynonymWord}`);

                if (selectedSynonymPhrase === selectedSynonymWord) {
                    phraseEl.classList.remove('selected');
                    wordEl.classList.remove('selected');
                    phraseEl.classList.add('correct');
                    wordEl.classList.add('correct');
                    phraseEl.onclick = null;
                    wordEl.onclick = null;
                    synonymCorrectMatches++;
                    updateSynonymMatchFeedback();
                } else {
                    phraseEl.classList.add('incorrect');
                    wordEl.classList.add('incorrect');
                    setTimeout(() => {
                        phraseEl.classList.remove('incorrect', 'selected');
                        wordEl.classList.remove('incorrect', 'selected');
                    }, 1000);
                }
                
                selectedSynonymPhrase = null;
                selectedSynonymWord = null;
            }
        }
        
        // --- Activity 12: Dealing with Grievances ---
        const grievancesData = [
            { number: 1, answer: 'occur' }, { number: 7, answer: 'disciplinary' },
            { number: 2, answer: 'conditions' }, { number: 8, answer: 'representative' },
            { number: 3, answer: 'safety' }, { number: 9, answer: 'policy' },
            { number: 4, answer: 'entitled' }, { number: 10, answer: 'behaviour' },
            { number: 5, answer: 'entitlement' }, { number: 6, answer: 'breaking' }
        ];

        function destroyGrievances() {
            const container = document.getElementById('grievances-container');
            if (container) container.innerHTML = '';
        }

        function initGrievances() {
            destroyGrievances();
            const container = document.getElementById('grievances-container');
            const text = `Problems can ______<span class="text-sm font-bold">(1)</span> in the best run companies for many reasons, such as over terms and ______<span class="text-sm font-bold">(2)</span>, management decisions, discrimination (on grounds of race, sex, disability, and religion), sexual harassment, bullying, health, and ______<span class="text-sm font-bold">(3)</span> issues.
            <br><br>
            Within two months of starting a job, employees are ______<span class="text-sm font-bold">(4)</span> to a written statement setting down the main conditions of their employment. As well as information on pay, hours, holiday ______<span class="text-sm font-bold">(5)</span>, and notice periods, the statement must also cover what the company will do if they have to discipline an employee for ______<span class="text-sm font-bold">(6)</span> the rules (the warning procedure) and who the employee can apply to if they are dissatisfied with a ______<span class="text-sm font-bold">(7)</span> decision. All employees have the right to be accompanied by another employee or a union ______<span class="text-sm font-bold">(8)</span> (if applicable) at any disciplinary interview.
            <br><br>
            A disciplinary procedure would normally be used when an employee does not follow company ______<span class="text-sm font-bold">(9)</span>, breaks rules, or displays inappropriate workplace behaviour. Employees must be fully informed of their inappropriate ______<span class="text-sm font-bold">(10)</span> and given an opportunity to explain themselves. The procedure should be handled in a private and respectful manner and the employee's previous record should be taken into account.`;

            let currentInput = 0;
            const gappedText = text.replace(/______/g, () => {
                currentInput++;
                return `<input type="text" id="grievance-gap-${currentInput}" class="mx-2 align-middle" style="width: 120px;">`;
            });
            container.innerHTML = `<p>${gappedText}</p>`;
        }

        function checkGrievances() {
            grievancesData.forEach(item => {
                const inputEl = document.getElementById(`grievance-gap-${item.number}`);
                if (inputEl) {
                    if (inputEl.value.trim().toLowerCase() === item.answer.toLowerCase()) {
                        inputEl.style.borderColor = '#38a169';
                        inputEl.style.backgroundColor = '#c6f6d5';
                    } else {
                        inputEl.style.borderColor = '#c53030';
                        inputEl.style.backgroundColor = '#fed7d7';
                    }
                }
            });
        }


        // --- Activity 13: True or False ---
        const trueFalseData = [
            { statement: "Melanie has applied for a position as Call Centre Assistant.", answer: false, explanation: "She applied for a Team Leader position." },
            { statement: "She sent a CV with her letter of application.", answer: true, explanation: "" },
            { statement: "The whole recruitment process will be completed within two weeks.", answer: false, explanation: "The initial interview is within two weeks, but the assessment centre is next month." },
            { statement: "The company will pay for Melanie's journey to the interview.", answer: true, explanation: "" },
            { statement: "Applicants will be told what the assessment centre procedure involves when they get to the company.", answer: false, explanation: "Full details will be sent in advance if selected." },
            { statement: "They want Melanie to complete an application form.", answer: true, explanation: "" },
            { statement: "Melanie has to call Madrid to arrange the interview.", answer: false, explanation: "She has to call the London office." }
        ];

        function destroyTrueFalse() {
            document.getElementById('true-false-container').innerHTML = '';
        }

        function initTrueFalse() {
            destroyTrueFalse();
            const container = document.getElementById('true-false-container');
            trueFalseData.forEach((item, index) => {
                container.innerHTML += `
                    <div id="tf-q-${index}" class="p-4 border border-gray-200 rounded-lg">
                        <p class="font-semibold mb-3">${index + 1}. ${item.statement}</p>
                        <div class="flex space-x-6">
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="tf-${index}" value="true" class="mr-2"> True
                            </label>
                            <label class="flex items-center cursor-pointer">
                                <input type="radio" name="tf-${index}" value="false" class="mr-2"> False
                            </label>
                        </div>
                        <div id="tf-feedback-${index}" class="feedback mt-2"></div>
                    </div>
                `;
            });
        }

        function checkTrueFalse() {
            trueFalseData.forEach((item, index) => {
                const selected = document.querySelector(`input[name="tf-${index}"]:checked`);
                const feedbackEl = document.getElementById(`tf-feedback-${index}`);
                const questionContainer = document.getElementById(`tf-q-${index}`);
                
                questionContainer.style.borderWidth = '2px';

                if (selected) {
                    const isCorrect = (selected.value === String(item.answer));
                    if (isCorrect) {
                        feedbackEl.textContent = "Correct!";
                        feedbackEl.className = 'feedback correct';
                        questionContainer.style.borderColor = '#38a169';
                    } else {
                        feedbackEl.textContent = `Incorrect. The correct answer is ${item.answer}. ${item.explanation}`;
                        feedbackEl.className = 'feedback incorrect';
                        questionContainer.style.borderColor = '#c53030';
                    }
                } else {
                    feedbackEl.textContent = "Please select an answer.";
                    feedbackEl.className = 'feedback incorrect';
                    questionContainer.style.borderColor = '#c53030';
                }
            });
        }

        // --- Activity 14: Fill the Gaps ---
        const fillGapsData = [
            { sentence: "My best marketing assistant has ______. She's got herself another job with more money!", answer: "resigned" },
            { sentence: "Will we be able to ______ a replacement when John hands in his resignation?", answer: "take on" },
            { sentence: "We can't continue working in these freezing temperatures, so we'll have to ______ six workers until the end of February.", answer: "lay off" },
            { sentence: "Those staff who can't relocate to the new factory in the north when we close down will be ______.", answer: "made redundant" },
            { sentence: "Fill me in on the details; I believe one of our shop assistants has been ______ for stealing, is that right?", answer: "sacked" },
            { sentence: "A new directive from head office has been introduced that all employees over 63 will be ______.", answer: "offered early retirement" }
        ];

        function destroyFillGaps() {
            document.getElementById('fill-gaps-container').innerHTML = '';
        }

        function initFillGaps() {
            destroyFillGaps();
            const container = document.getElementById('fill-gaps-container');
            fillGapsData.forEach((item, index) => {
                const sentenceHtml = item.sentence.replace('______', `<input type="text" id="gap-${index}" class="mx-2 align-middle">`);
                container.innerHTML += `
                    <div class="p-3 bg-gray-50 rounded-lg">
                        <p>${index + 1}. ${sentenceHtml}</p>
                        <div id="gap-feedback-${index}" class="feedback text-sm mt-1 ml-6"></div>
                    </div>
                `;
            });
        }

        function checkFillGaps() {
            fillGapsData.forEach((item, index) => {
                const inputEl = document.getElementById(`gap-${index}`);
                const feedbackEl = document.getElementById(`gap-feedback-${index}`);
                const userAnswer = inputEl.value.trim().toLowerCase();
                const correctAnswer = item.answer.toLowerCase();

                if (userAnswer === correctAnswer) {
                    feedbackEl.textContent = "Correct!";
                    feedbackEl.className = 'feedback text-sm mt-1 ml-6 correct';
                    inputEl.style.borderColor = '#38a169';
                    inputEl.style.backgroundColor = '#c6f6d5';
                } else {
                    feedbackEl.textContent = `Not quite. The correct answer is "${item.answer}".`;
                    feedbackEl.className = 'feedback text-sm mt-1 ml-6 incorrect';
                    inputEl.style.borderColor = '#c53030';
                    inputEl.style.backgroundColor = '#fed7d7';
                }
            });
        }


        // --- Initial Load ---
        window.onload = () => {
            // Only the home page is visible initially. Activities are initialized on demand.
        };
    </script>
</body>
</html>

